from gensim.models import Word2Vec
import pickle
import numpy as np


with open(r'src\src\files.pkl', 'rb') as f:
    labels = pickle.load(f)
    files = pickle.load(f)

with open(r'src\src\test_files.pkl', 'rb') as f:
    files2 = pickle.load(f)

text_data=[]

# # 将每个文本中的api名字按照空格分开，并将其放入一个二维列表中
# for i in files:
#     text_data_i = i.split()
#     text_data.append(text_data_i)

text_data = [i for j in files for i in j]
tmp = [i for j in files2 for i in j]

text_data += tmp

# 训练Word2Vec模型
model = Word2Vec(text_data, vector_size=32, window=512, min_count=1, workers=8)
model.save(r"src\w2v32.model")

# 获取API名称的词向量
api1_vec = model.wv['NtTerminateProcess']
print(api1_vec)

# 获取与API名称最相似的词
similar_words = model.wv.most_similar('NtTerminateProcess')
print(similar_words)
